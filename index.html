<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="assets/css/starter.css">
    <title>Matthews-Kennington Wedding</title>
  </head>
  <body data-bs-spy="scroll" data-bs-target="#navbar" data-bs-offset="0">
    <nav id="navbar" class="navbar fixed-top navbar-expand navbar-transparent text-shadow-primary">
      <div class="container-fluid flex-column">
        <a class="navbar-brand display-1 font-blooming-elegant mx-0" href="#">Kristian & Paul</a>
        <ul class="navbar-nav flex-row">
          <li class="nav-item">
            <a class="nav-link" href="#how-we-met">How We Met</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#engagement">Our Engagement</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#venue">The Venue</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="block block-fill-height text-center text-shadow-sm-primary">
      <div class="block-xs-middle">
        <div class="block-foreground">
          <h1 class="display-1 font-blooming-elegant user-select-none">
            <div class="font-doodles-1 font-75 mb-n3">w</div>
            <div class="pulse">M<span class="font-doodles-2 font-50">6</span>K</div>
            <div class="font-doodles-1 font-75 mt-n3" style="transform: rotate(180deg);">w</div>
          </h1>
          <h2 class="display-2 font-doodles-1 continue user-select-none">4</h2>
        </div>
        <div class="block-background" style="background-image: url('assets/video/hero-frame.jpg'); background-position: center center; background-size: cover;">
          <video id="hero-video" autoplay loop muted preload="auto" poster="assets/video/hero-frame.jpg">
            <source src="assets/video/hero-4k.mov" type="video/mp4">
            <source src="assets/video/hero-hd-1080p.mov" type="video/mp4" media="(max-width: 1920px)">
            <source src="assets/video/hero-hd-720p.mov" type="video/mp4" media="(max-width: 1280px)">
            <source src="assets/video/hero-large-540p.mov" type="video/mp4" media="(max-width: 960px)">
            <source src="assets/video/hero-sd-480p.mov" type="video/mp4" media="(max-width: 640px)">
            <source src="assets/video/hero-small.mov" type="video/mp4" media="(max-width: 428px)">
          </video>
        </div>
      </div>
    </div>

    <div id="how-we-met" class="block text-center px-0">
      <div class="block-xs-middle">
        <div class="block-foreground">
          <div class="container-fluid">
            <h2 class="block-title text-shadow-sm-primary">How We Met</h2>
            <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 justify-content-around align-items-center g-4 pb-4" style="overflow-x: hidden;">
              <div class="col">
                <div class="card shadow img-thumbnail text-primary text-start" style="transform: rotate(-4deg);">
                  <img src="assets/img/how-we-met-1.jpeg" class="card-img-top" alt="Kristian & Paul">
                  <div class="card-body">
                    <p class="card-text lead">We met officially on 3<sup>rd</sup> October 2019. We both, separately, arranged to go to our friend’s Jim birthday meal in Manchester. We’d never met each other before, but had seen each other online, Paul saw Kristian on Facebook, tagged in a post in August when he visited our friends’s Ben and Farran in Leeds and Kristian had stumbled upon Paul’s instagram.</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="card shadow img-thumbnail text-primary text-start" style="transform: rotate(2deg);">
                  <img src="assets/img/how-we-met-2.jpeg" class="card-img-top" alt="Kristian & Paul">
                  <div class="card-body">
                    <p class="card-text lead">Back to the meal, we both arrived promptly and sat next to each other. Neither of us said a word to each other, but funnily ordered the same meal. The meal finished without either of us saying anything to each other and then we all went to play crazy golf.</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="card shadow img-thumbnail text-primary text-start" style="transform: rotate(-1deg);">
                  <img src="assets/img/how-we-met-3.jpeg" class="card-img-top" alt="Kristian & Paul">
                  <div class="card-body">
                    <p class="card-text lead">We both played appallingly, coming last and second to last. We briefly chatted about our poor performance in the golf, but sadly the night was over and Paul had to make his way back to Leeds.</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="card shadow img-thumbnail text-primary text-start" style="transform: rotate(3deg);">
                  <img src="assets/img/how-we-met-4.jpeg" class="card-img-top" alt="Paul & Kristian">
                  <div class="card-body">
                    <p class="card-text lead">When Paul got home, just after midnight, he was delighted to see that Kristian had tracked him down on Facebook and sent him a message (Paul was also planning on doing the same). We stayed up chatting until around 3 am before tiredness took over and bed beckoned. Thankfully Jim’s birthday festivities were carrying on into the next day, and Kristian was coming to Leeds!</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="card shadow img-thumbnail text-primary text-start" style="transform: rotate(-5deg);">
                  <img src="assets/img/how-we-met-5.jpeg" class="card-img-top" alt="Paul & Kristian">
                  <div class="card-body">
                    <p class="card-text lead">We met at Geek Retreat to play board games but neither of us were interested in playing the games. Instead, we spent the whole time trading clandestine text messages without the knowledge of anyone around us. We can officially say we hit it off and arranged to meet the next day for an official date.</p>
                  </div>
                </div>
              </div>
            </div>
            <p class="display-2 font-blooming-elegant mt-3">The rest is history.</p>
          </div>
        </div>
        <div class="block-background" style="background-image: url('assets/img/artwork-top.png'); background-repeat: no-repeat; background-position: center top; background-size: 100% auto;"></div>
      </div>
    </div>

    <div id="engagement" class="block text-center px-0">
      <div class="ratio ratio-16x9">
        <div class="block text-shadow-sm-primary" style="left: 50%; z-index: 1; width: auto; height: auto; transform: translateX(-50%);">
          <h2 class="block-title">Our Engagement</h2>
          <p class="lead">22<sup>nd</sup> November 2020</p>
        </div>
        <video autoplay loop muted controls preload="auto" poster="assets/video/engagement-frame.jpg">
          <source src="assets/video/engagement-4k.mov" type="video/mp4">
          <source src="assets/video/engagement-hd-1080p.mov" type="video/mp4" media="(max-width: 1920px)">
          <source src="assets/video/engagement-hd-720p.mov" type="video/mp4" media="(max-width: 1280px)">
          <source src="assets/video/engagement-large-540p.mov" type="video/mp4" media="(max-width: 960px)">
          <source src="assets/video/engagement-sd-480p.mov" type="video/mp4" media="(max-width: 640px)">
          <source src="assets/video/engagement-small.mov" type="video/mp4" media="(max-width: 428px)">
        </video>
      </div>
    </div>

    <div id="venue" class="block block-fill-height text-center">
      <div class="block-xs-middle">
        <div class="block-foreground w-100">
          <div class="container-fluid">
            <h2 class="block-title text-shadow-sm-primary">The Venue</h2>
            <h3 class="display-2">Crowne Plaza, Leeds</h3>
            <div class="row align-items-center">
              <div class="col-12 col-md-6 mb-3">
                <div class="ratio ratio-4x3">
                  <div id="map" class="img-thumbnail"></div>
                </div>
              </div>
              <div class="col-12 col-md-6 text-md-start">
                <h4>How to find the venue</h4>
                <p>How to get to the Crowne Plaza, Leeds</p>
                <div class="accordion" id="accordionFind">
                  <div class="accordion-item">
                    <h4 class="accordion-header" id="headingCar">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCar" aria-expanded="false" aria-controls="collapseCar">
                        By Car
                      </button>
                    </h2>
                    <div id="collapseCar" class="accordion-collapse collapse text-primary text-start" aria-labelledby="headingCar" data-bs-parent="#accordionFind">
                      <div class="accordion-body">
                        <p>When you come to Leeds, head for the City Centre at Junction 3 from the M621. Crowne Plaza is located within easy access to the M621, M1 and M62 in the City Centre of Leeds on Wellington Street.</p>
                        <p>Crowne Plaza has 120 onsite parking spaces for you to use at £3.50 per vehicle or £10 per vehicle for 24 hours if you're staying overnight. If you wish to use the onsite parking facilities, you are required to enter and record your car registration number onto an online system. The Crowne Plaza team will be on hand to advise and assist you with this process on arrival.</p>
                        <dl class="row">
                          <dt class="col-sm-3">Satellite Navigation:</dt>
                          <dd class="col-sm-9">LS1 4AP</dd>
                        </dl>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h4 class="accordion-header" id="headingTrain">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTrain" aria-expanded="false" aria-controls="collapseTrain">
                        By Train
                      </button>
                    </h2>
                    <div id="collapseTrain" class="accordion-collapse collapse text-primary text-start" aria-labelledby="headingTrain" data-bs-parent="#accordionFind">
                      <div class="accordion-body">
                        <p>Exit the station by the City Square exit, turn left onto Wellington Street, the hotel is located 0.5 miles on the left hand side.</p>
                        <a class="btn btn-secondary" href="https://nationalrail.co.uk/stations_destinations/LDS.aspx" target="_blank">National Rail</a>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h4 class="accordion-header" id="headingAir">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAir" aria-expanded="false" aria-controls="collapseAir">
                        By Air
                      </button>
                    </h2>
                    <div id="collapseAir" class="accordion-collapse collapse text-primary text-start" aria-labelledby="headingAir" data-bs-parent="#accordionFind">
                      <div class="accordion-body">
                        <p>Leeds Bradford LBA distance 12 miles or 20 minutes by taxi £22 fare.</p>
                        <a class="btn btn-secondary" href="https://leedsbradfordairport.co.uk" target="_blank">Leeds Bradford Airport</a>
                        <a class="btn btn-secondary" href="https://m.uber.com/ul?client_id=zA7oCmocQmnmo6_cPLyBds7MoGvAVVhZ&action=setPickup&pickup=my_location&dropoff[latitude]=53.796570&dropoff[longitude]=-1.557678&dropoff[nickname]=Crowne%20Plaza%2C%20Leeds&dropoff[formatted_address]=Crowne%20Plaza%20Leeds%0AWellington%20Street%0ALeeds%2C%20LS1%204DL%0AUnited%20Kingdom" target="_blank">Book an Uber</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="block-background" style="background-image: url('assets/img/artwork-left-bottom.png'); background-repeat: no-repeat; background-position: left bottom; background-size: contain;"></div>
      </div>
    </div>

    <div class="modal fade" id="thanksModal" tabindex="-1" aria-labelledby="thanksModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered text-center">
        <div class="modal-content bg-primary">
          <div class="modal-header border-bottom-0">
            <h1 class="modal-title font-blooming-elegant" id="thanksModalLabel">Hello,</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p class="lead" id="thanksModalBody">Thank you for confirming your attendance at our wedding.</p>
          </div>
          <div class="modal-footer border-top-0">
            <a class="btn btn-primary" href="../assets/wedding.ics" download="Kristian & Paul's Wedding">Add to Calendar</a>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="assets/js/starter.js"></script>
    <script src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js"></script>
    <script>
      const bsPrimary = getComputedStyle(document.documentElement).getPropertyValue("--bs-primary");
      const tokenId = "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IlRWWTJZU0hUMk0ifQ.eyJpc3MiOiIzNFdVS1FCWFhIIiwiaWF0IjoxNjIzODQ4MzEwLCJleHAiOjE2NTUzMzc2MDAsIm9yaWdpbiI6IndlZGRpbmcubWF0dGhld3Mta2VubmluZ3Rvbi5jb20ifQ.WqERpuk9Ol5SZsEodrDas4FLRItWD9U1DWxIHwK14Beq3IYM6-p0JXDtoYX5xIth6xTGfW5YQBPvk4OmYR8Yjw";

      const places = {
        crownePlaza: {
          title: "Crowne Plaza",
          glyphImage: "assets/img/mk.png",
          lookup: "Crowne Plaza, Leeds"
        },
        busStation: {
          title: "Bus Station",
          glyphImage: "assets/img/metro.png",
          lookup: "Leeds Bus Station"
        },
        trainStation: {
          title: "Train Station",
          glyphImage: "assets/img/national-rail.png",
          lookup: "Leeds Station"
        },
        airport: {
          title: "LBA Airport",
          glyphImage: "assets/img/lba-airport.png",
          lookup: "LBA Airport"
        }
      };

      const accordian = {
        car: {
          active: false,
          collapsible: document.getElementById("collapseCar")
        },
        train: {
          active: false,
          collapsible: document.getElementById("collapseTrain")
        },
        air: {
          active: false,
          collapsible: document.getElementById("collapseAir")
        }
      }

      const heroVideo = document.getElementById("hero-video");
      const collapsibleCar = document.getElementById("collapseCar");
      const collapsibleTrain = document.getElementById("collapseTrain");
      const collapsibleAir = document.getElementById("collapseAir");

      const heroVideoPromise = heroVideo.play();

      document.addEventListener("DOMContentLoaded", function() {
        const searchParams = new URLSearchParams(window.location.search);

        if (searchParams.has("modal")) {
          const modalSearchParam = searchParams.get("modal");
          const nameSearchParam = searchParams.get("name");
          const attendingSearchParam = searchParams.get("attending") === "Yes";

          const thanksModalLabel = document.getElementById("thanksModalLabel");
          const thanksModalBody = document.getElementById("thanksModalBody");

          const firstName = nameSearchParam.split(' ')[0];

          thanksModalLabel.textContent = `Hello ${firstName},`;

          switch (attendingSearchParam) {
            case true:
              thanksModalBody.textContent = "Thank you for confirming your attendance at our wedding, we look forward to seeing you!";
              break;
            case false:
              thanksModalBody.textContent = "We're sorry you can't join us.";
              break;
          }

          if (modalSearchParam === "thanks") {
            const thanksModal = new Modal(document.getElementById("thanksModal"));

            thanksModal.show();
          }
        }
      });

      if (heroVideoPromise !== undefined) {
        heroVideoPromise.catch(function (error) {
          heroVideo.remove();
        });
      }

      mapkit.init({
        authorizationCallback: function(done) {
          done(tokenId);
        }
      });

      const directions = new mapkit.Directions();
      const geocoder = new mapkit.Geocoder();
      const pointOfInterestFilter = new mapkit.PointOfInterestFilter.including([
        mapkit.PointOfInterestCategory.Hotel,
        mapkit.PointOfInterestCategory.Airport,
        mapkit.PointOfInterestCategory.ATM,
        mapkit.PointOfInterestCategory.Bank,
        mapkit.PointOfInterestCategory.CarRental,
        mapkit.PointOfInterestCategory.EVCharger,
        mapkit.PointOfInterestCategory.FireStation,
        mapkit.PointOfInterestCategory.GasStation,
        mapkit.PointOfInterestCategory.Hospital,
        mapkit.PointOfInterestCategory.Parking,
        mapkit.PointOfInterestCategory.Pharmacy,
        mapkit.PointOfInterestCategory.Police,
        mapkit.PointOfInterestCategory.PublicTransport,
        mapkit.PointOfInterestCategory.Restroom
      ]);
      const style = new mapkit.Style({
        lineWidth: 4,
        strokeColor: bsPrimary,
        strokeOpacity: .8
      });
      const lineGradient = new mapkit.LineGradient({
        0: "transparent",
        1: bsPrimary
      });

      for (const key in places) {
        geocoder.lookup(places[key].lookup, function (error, data) {
          places[key].place = data.results[0];

          checkPlaces(places);
        }, { limitToCountries: "GB" });
      }

      let placesPassed = false;
      function checkPlaces(places) {
        if (placesPassed) return;

        for (const key in places) {
          if (places[key].place === undefined) return;
        }

        placesPassed = true;

        createAnnotations(places);
      }

      function createAnnotations(places) {
        for (const key in places) {
          places[key].annotation = new mapkit.MarkerAnnotation(places[key].place.coordinate, {
            color: bsPrimary,
            title: places[key].title,
            glyphImage: { 1: places[key].glyphImage }
          });
        }

        places.crownePlaza.annotation.selected = true;

        places.busStation.annotation.displayPriority = mapkit.Annotation.DisplayPriority.High;
        places.trainStation.annotation.displayPriority = mapkit.Annotation.DisplayPriority.High;
        places.airport.annotation.displayPriority = mapkit.Annotation.DisplayPriority.High;

        places.trainStation.annotation.addEventListener("select", function (event) {
          if (accordian.train.active) return;

          const bsTarget = document.querySelector('[data-bs-target="#collapseTrain"]');

          bsTarget.click();
        });

        places.airport.annotation.addEventListener("select", function (event) {
          if (accordian.air.active) return;

          const bsTarget = document.querySelector('[data-bs-target="#collapseAir"]');

          bsTarget.click();
        });

        createMap(places);
      };

      let map;

      function createMap(places) {
        const annotations = [];
        for (const key in places) {
          annotations.push(places[key].annotation);
        }

        map = new mapkit.Map("map", {
          region: places.crownePlaza.place.region,
          center: places.crownePlaza.place.coordinate,
          tintColor: bsPrimary,
          pointOfInterestFilter: pointOfInterestFilter,
          annotations: annotations
        });
      }

      accordian.car.collapsible.addEventListener('show.bs.collapse', function () {
        accordian.car.active = true;

        geocoder.lookup("M621, Holbeck", function (error, data) {
          directions.route({
            origin: data.results[0],
            destination: places.crownePlaza.place,
            transportType: mapkit.Directions.Transport.Walking,
            arrivalDate: new Date(2022, 03, 26, 12)
          }, function (error, data) {
            data.routes[0].polyline.style = style;

            map.showItems([
              places.crownePlaza.annotation,
              data.routes[0].polyline
            ], { animate: true });
          });
        }, {
          region: places.crownePlaza.place.region,
          limitToCountries: "GB"
        });

        map.removeOverlays(map.overlays);
      });

      accordian.train.collapsible.addEventListener('show.bs.collapse', function () {
        accordian.train.active = true;

        directions.route({
          origin: places.trainStation.place,
          destination: places.crownePlaza.place,
          transportType: mapkit.Directions.Transport.Walking,
          arrivalDate: new Date(2022, 03, 26, 12)
        }, function (error, data) {
          data.routes[0].polyline.style = style;

          map.showItems([
            places.crownePlaza.annotation,
            places.trainStation.annotation,
            data.routes[0].polyline
          ], { animate: true });
        });

        map.removeOverlays(map.overlays);
      });

      accordian.air.collapsible.addEventListener('show.bs.collapse', function () {
        accordian.air.active = true;

        directions.route({
          origin: places.airport.place,
          destination: places.crownePlaza.place,
          transportType: mapkit.Directions.Transport.Automobile,
          arrivalDate: new Date(2022, 03, 26, 12)
        }, function (error, data) {
          data.routes[0].polyline.style = style;

          map.showItems([
            places.crownePlaza.annotation,
            places.airport.annotation,
            data.routes[0].polyline
          ], { animate: true });
        });
      });

      accordian.car.collapsible.addEventListener('hide.bs.collapse', function () {
        accordian.car.active = false;
        map.removeOverlays(map.overlays);
        map.showItems([ places.crownePlaza.annotation ], { animate: true });
      });

      accordian.train.collapsible.addEventListener('hide.bs.collapse', function () {
        accordian.train.active = false;
        map.removeOverlays(map.overlays);
        map.showItems([ places.crownePlaza.annotation ], { animate: true });
      });

      accordian.air.collapsible.addEventListener('hide.bs.collapse', function () {
        accordian.air.active = false;
        map.removeOverlays(map.overlays);
        map.showItems([ places.crownePlaza.annotation ], { animate: true });
      });
    </script>
  </body>
</html>
